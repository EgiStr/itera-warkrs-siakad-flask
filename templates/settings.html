{% extends "base.html" %}

{% block title %}Pengaturan - WAR KRS ITERA{% endblock %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h2><i class="bi bi-gear"></i> Pengaturan</h2>
        <p class="text-muted">Kelola kredensial SIAKAD, target mata kuliah, dan notifikasi Telegram.</p>
    </div>
</div>

<div class="row">
    <div class="col-lg-8">
        <form method="POST">
            {{ form.hidden_tag() }}
            
            <!-- SIAKAD Settings -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-key"></i> Cookies SIAKAD</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-info" role="alert">
                        <i class="bi bi-info-circle"></i>
                        <strong>Cara Mendapatkan Cookies:</strong> Login ke SIAKAD di browser, buka Developer Tools (F12), 
                        cari cookies CI_SESSION dan CF_CLEARANCE di tab Application/Storage.
                    </div>
                    
                    <div class="mb-3">
                        {{ form.ci_session.label(class="form-label") }}
                        {{ form.ci_session(class="form-control" + (" is-invalid" if form.ci_session.errors else ""), placeholder="Masukkan CI_SESSION cookie dari SIAKAD") }}
                        {% if form.ci_session.errors %}
                            <div class="invalid-feedback">
                                {% for error in form.ci_session.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">Cookie CI_SESSION untuk session SIAKAD yang valid.</div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.cf_clearance.label(class="form-label") }}
                        {{ form.cf_clearance(class="form-control" + (" is-invalid" if form.cf_clearance.errors else ""), placeholder="Masukkan CF_CLEARANCE cookie dari SIAKAD") }}
                        {% if form.cf_clearance.errors %}
                            <div class="invalid-feedback">
                                {% for error in form.cf_clearance.errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}
                        <div class="form-text">Cookie CF_CLEARANCE untuk bypass Cloudflare protection.</div>
                    </div>
                </div>
            </div>
            
            <!-- Target Courses -->
            <div class="card mb-4">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5><i class="bi bi-list-check"></i> Target Mata Kuliah</h5>
                    <a href="{{ url_for('courses') }}" class="btn btn-outline-primary btn-sm">
                        <i class="bi bi-plus-circle"></i> Kelola Course
                    </a>
                </div>
                <div class="card-body">
                    <div class="alert alert-info" role="alert">
                        <i class="bi bi-info-circle"></i>
                        <strong>Info:</strong> Pilih mata kuliah yang ingin didaftarkan secara otomatis. 
                        Sistem akan mencoba mendaftarkan semua mata kuliah yang dipilih.
                    </div>
                    
                    <!-- Course Selection Interface -->
                    <div class="mb-3">
                        <label class="form-label">{{ form.target_courses.label.text }}</label>
                        
                        <!-- Search and Filter -->
                        <div class="row mb-3">
                            <div class="col-lg-8 col-md-7 mb-2">
                                <input type="text" id="courseSearch" class="form-control" 
                                       placeholder="ðŸ” Cari mata kuliah berdasarkan kode atau nama..." autocomplete="off">
                            </div>
                            <div class="col-lg-4 col-md-5">
                                <select id="facultyFilter" class="form-select">
                                    <option value="">ðŸ“š Semua Fakultas</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Quick Actions for Mobile -->
                        <div class="d-md-none mb-3">
                            <div class="d-grid gap-2">
                                <button type="button" class="btn btn-outline-primary btn-sm" onclick="selectAllVisible()">
                                    <i class="bi bi-check-all"></i> Pilih Semua yang Terlihat
                                </button>
                                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clearAllSelections()">
                                    <i class="bi bi-x-circle"></i> Hapus Semua Pilihan
                                </button>
                            </div>
                        </div>
                        
                        <!-- Available Courses -->
                        <div class="border rounded p-3 mb-3" style="max-height: 400px; overflow-y: auto;">
                            <h6 class="text-muted mb-3">
                                <i class="bi bi-collection"></i> Mata Kuliah Tersedia 
                                <small id="courseCount" class="badge bg-secondary">0</small>
                            </h6>
                            <div id="availableCourses" class="row g-2">
                                <!-- Dynamic content will be populated here -->
                            </div>
                            <div id="noCourses" class="text-center py-4 d-none">
                                <i class="bi bi-search display-4 text-muted"></i>
                                <p class="text-muted mt-2">Tidak ada mata kuliah yang sesuai dengan pencarian.</p>
                            </div>
                        </div>
                        
                        <!-- Selected Courses -->
                        <div class="border rounded p-3 bg-light">
                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <h6 class="text-primary mb-0">
                                    <i class="bi bi-check-circle"></i> Mata Kuliah Terpilih 
                                    <small id="selectedCount" class="badge bg-primary">0</small>
                                </h6>
                                <div class="d-none d-md-block">
                                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clearAllSelections()">
                                        <i class="bi bi-x-circle"></i> Hapus Semua
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Selected Courses Summary -->
                            <div id="selectedSummary" class="d-none mb-3">
                                <div class="row text-center">
                                    <div class="col-4">
                                        <div class="small text-muted">Total SKS</div>
                                        <div class="fw-bold text-primary" id="totalSKS">0</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="small text-muted">Mata Kuliah</div>
                                        <div class="fw-bold text-success" id="totalCourses">0</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="small text-muted">Fakultas</div>
                                        <div class="fw-bold text-info" id="totalFaculties">0</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="selectedCourses" class="row g-2">
                                <div id="noSelection" class="col-12 text-center py-3 text-muted">
                                    <i class="bi bi-clipboard-x"></i>
                                    <p class="mb-0">Belum ada mata kuliah yang dipilih</p>
                                    <small>Klik pada mata kuliah di atas untuk memilih</small>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Hidden form field -->
                        {{ form.target_courses(style="display: none;") }}
                        <div class="form-text mt-2">
                            <i class="bi bi-lightbulb"></i> 
                            <strong>Tips:</strong> Klik pada mata kuliah untuk memilih/membatalkan pilihan. 
                            Gunakan pencarian untuk menemukan mata kuliah dengan cepat.
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Telegram Notifications -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="bi bi-telegram"></i> Notifikasi Telegram (Opsional)</h5>
                </div>
                <div class="card-body">
                    <div class="alert alert-warning" role="alert">
                        <i class="bi bi-exclamation-triangle"></i>
                        <strong>Opsional:</strong> Fitur ini untuk mendapatkan notifikasi hasil WAR via Telegram.
                    </div>
                    
                    <div class="mb-3">
                        {{ form.telegram_bot_token.label(class="form-label") }}
                        {{ form.telegram_bot_token(class="form-control", placeholder="Bot Token dari @BotFather") }}
                        <div class="form-text">
                            Dapatkan bot token dari <a href="https://t.me/botfather" target="_blank">@BotFather</a> di Telegram.
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        {{ form.telegram_chat_id.label(class="form-label") }}
                        {{ form.telegram_chat_id(class="form-control", placeholder="Chat ID Telegram Anda") }}
                        <div class="form-text">
                            Chat ID bisa didapat dari <a href="https://t.me/userinfobot" target="_blank">@userinfobot</a>.
                        </div>
                    </div>
                    
                    <!-- Test Telegram Button -->
                    <div class="mt-3">
                        <button type="button" class="btn btn-outline-primary" id="test-telegram-btn">
                            <i class="bi bi-send"></i> Test Kirim Pesan Telegram
                        </button>
                        <div id="telegram-test-result" class="mt-2"></div>
                    </div>
                </div>
            </div>
            
            <!-- Submit Button -->
            <div class="d-grid">
                {{ form.submit(class="btn btn-primary btn-lg") }}
            </div>
        </form>
    </div>
    
    <!-- Help Sidebar -->
    <div class="col-lg-4">
        <div class="card">
            <div class="card-header">
                <h6><i class="bi bi-question-circle"></i> Bantuan Setup</h6>
            </div>
            <div class="card-body">
                <h6>1. Cara Mendapatkan Cookies SIAKAD</h6>
                <ol class="small">
                    <li>Login ke <a href="https://siakad.itera.ac.id" target="_blank">SIAKAD ITERA</a></li>
                    <li>Tekan F12 untuk buka Developer Tools</li>
                    <li>Pergi ke tab Application â†’ Storage â†’ Cookies</li>
                    <li>Cari dan copy values dari CI_SESSION dan CF_CLEARANCE</li>
                    <li>Paste ke form di sebelah kiri</li>
                </ol>
                
                <h6>2. Pilih Mata Kuliah</h6>
                <p class="small">Pilih mata kuliah yang ingin didaftarkan secara otomatis. Sistem akan mencoba mendaftarkan semua mata kuliah yang dipilih.</p>
                
                <h6>3. Notifikasi Telegram</h6>
                <ol class="small">
                    <li>Chat ke <a href="https://t.me/botfather" target="_blank">@BotFather</a></li>
                    <li>Ketik <code>/newbot</code></li>
                    <li>Ikuti instruksi dan dapatkan token</li>
                    <li>Chat ke <a href="https://t.me/userinfobot" target="_blank">@userinfobot</a> untuk mendapatkan Chat ID</li>
                </ol>
            </div>
        </div>
        
        <div class="card mt-3">
            <div class="card-header">
                <h6><i class="bi bi-shield-check"></i> Keamanan</h6>
            </div>
            <div class="card-body">
                <p class="small">
                    <i class="bi bi-lock text-success"></i> 
                    Password SIAKAD dienkripsi dengan algoritma Fernet
                </p>
                <p class="small">
                    <i class="bi bi-server text-info"></i> 
                    Data disimpan lokal di server, tidak dikirim ke pihak ketiga
                </p>
                <p class="small">
                    <i class="bi bi-eye-slash text-primary"></i> 
                    Admin sistem tidak dapat melihat password asli Anda
                </p>
            </div>
        </div>
    </div>
</div>

<script>
// Course Selection Management
let allCourses = [];
let selectedCourses = new Set();

// Initialize course selection
document.addEventListener('DOMContentLoaded', function() {
    initializeCourseSelection();
    setupEventListeners();
});

function initializeCourseSelection() {
    // Get all courses from the hidden select element
    const selectElement = document.querySelector('select[name="target_courses"]');
    if (!selectElement) {
        console.log('âŒ Select element not found');
        return;
    }
    
    console.log('ðŸ” Found select element with', selectElement.options.length, 'options');
    
    allCourses = Array.from(selectElement.options).map(option => {
        const text = option.text;
        const value = option.value;
        
        console.log('Processing option:', { value, text });
        
        // Skip empty or no_courses options
        if (!value || value === 'no_courses') {
            console.log('Skipping option:', value);
            return null;
        }
        
        // Parse course information
        let courseCode = '', courseName = '', faculty = '', sks = '';
        
        if (text.includes(' - ')) {
            const parts = text.split(' - ');
            const leftPart = parts[0]; // "AR25-11001 (RA)" or "AR25-11001 (RA) [3 SKS]"
            courseName = parts[1]; // "Studio Dasar 1"
            
            // Extract course code and class
            if (leftPart.includes('(') && leftPart.includes(')')) {
                const codePart = leftPart.substring(0, leftPart.indexOf('(')).trim();
                const classPart = leftPart.substring(leftPart.indexOf('(') + 1, leftPart.indexOf(')')).trim();
                courseCode = `${codePart} (${classPart})`;
            } else {
                courseCode = leftPart;
            }
            
            // Extract SKS if present
            if (leftPart.includes('[') && leftPart.includes('SKS]')) {
                const sksMatch = leftPart.match(/\[(\d+)\s*SKS\]/);
                if (sksMatch) sks = sksMatch[1];
            }
            

        } else {
            // Handle simple text or fallback messages
            if (text.includes('ðŸ“ Tidak ada mata kuliah')) {
                return null; // Skip this option
            }
            courseCode = text;
            courseName = text;
            faculty = 'Lainnya';
        }
        
        return {
            value: value,
            courseCode: courseCode,
            courseName: courseName,
            faculty: faculty,
            sks: sks,
            fullText: text
        };
    }).filter(course => course !== null); // Remove null entries
    
    console.log('âœ… Processed courses:', allCourses.length, 'courses');
    console.log('Sample courses:', allCourses.slice(0, 3));
    
    // Get currently selected courses
    selectedCourses = new Set(Array.from(selectElement.selectedOptions).map(option => option.value));
    console.log('ðŸŽ¯ Selected courses:', selectedCourses.size, 'courses');
    
    // Populate faculty filter
    populateFacultyFilter();
    
    // Render courses
    renderAvailableCourses();
    renderSelectedCourses();
    updateCounts();
}

function populateFacultyFilter() {
    const facultyFilter = document.getElementById('facultyFilter');
    const faculties = [...new Set(allCourses.map(course => course.faculty))].sort();
    
    faculties.forEach(faculty => {
        const option = document.createElement('option');
        option.value = faculty;
        option.textContent = faculty;
        facultyFilter.appendChild(option);
    });
}

function setupEventListeners() {
    // Search functionality
    document.getElementById('courseSearch').addEventListener('input', function(e) {
        renderAvailableCourses(e.target.value);
    });
    
    // Faculty filter
    document.getElementById('facultyFilter').addEventListener('change', function(e) {
        const searchTerm = document.getElementById('courseSearch').value;
        renderAvailableCourses(searchTerm, e.target.value);
    });
    
    // Telegram test button
    const testTelegramBtn = document.getElementById('test-telegram-btn');
    if (testTelegramBtn) {
        testTelegramBtn.addEventListener('click', function() {
            const botToken = document.querySelector('input[name="telegram_bot_token"]').value;
            const chatId = document.querySelector('input[name="telegram_chat_id"]').value;
            const resultDiv = document.getElementById('telegram-test-result');
            const button = this;
            
            // Validasi input
            if (!botToken) {
                resultDiv.innerHTML = '<div class="alert alert-warning">Masukkan Bot Token terlebih dahulu!</div>';
                return;
            }
            
            if (!chatId) {
                resultDiv.innerHTML = '<div class="alert alert-warning">Masukkan Chat ID terlebih dahulu!</div>';
                return;
            }
            
            // Disable button dan show loading
            button.disabled = true;
            button.innerHTML = '<i class="bi bi-hourglass-split"></i> Mengirim...';
            
            // Kirim request test
            fetch('/test_telegram', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    bot_token: botToken,
                    chat_id: chatId
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    resultDiv.innerHTML = '<div class="alert alert-success"><i class="bi bi-check-circle"></i> ' + data.message + '</div>';
                } else {
                    resultDiv.innerHTML = '<div class="alert alert-danger"><i class="bi bi-exclamation-triangle"></i> ' + data.message + '</div>';
                }
            })
            .catch(error => {
                resultDiv.innerHTML = '<div class="alert alert-danger"><i class="bi bi-exclamation-triangle"></i> Error: ' + error.message + '</div>';
            })
            .finally(() => {
                // Re-enable button
                button.disabled = false;
                button.innerHTML = '<i class="bi bi-send"></i> Test Kirim Pesan Telegram';
            });
        });
    }
}

function renderAvailableCourses(searchTerm = '', facultyFilter = '') {
    const container = document.getElementById('availableCourses');
    const noCourses = document.getElementById('noCourses');
    
    // Filter courses
    let filteredCourses = allCourses.filter(course => {
        const matchesSearch = !searchTerm || 
            course.courseCode.toLowerCase().includes(searchTerm.toLowerCase()) ||
            course.courseName.toLowerCase().includes(searchTerm.toLowerCase());
        
        const matchesFaculty = !facultyFilter || course.faculty === facultyFilter;
        
        return matchesSearch && matchesFaculty;
    });
    
    container.innerHTML = '';
    
    if (filteredCourses.length === 0) {
        noCourses.classList.remove('d-none');
        return;
    } else {
        noCourses.classList.add('d-none');
    }
    
    filteredCourses.forEach(course => {
        const isSelected = selectedCourses.has(course.value);
        const courseElement = createCourseCard(course, isSelected, false);
        container.appendChild(courseElement);
    });
    
    document.getElementById('courseCount').textContent = filteredCourses.length;
}

function renderSelectedCourses() {
    const container = document.getElementById('selectedCourses');
    const noSelection = document.getElementById('noSelection');
    const summary = document.getElementById('selectedSummary');
    
    container.innerHTML = '';
    
    if (selectedCourses.size === 0) {
        container.appendChild(noSelection);
        summary.classList.add('d-none');
        return;
    }
    
    summary.classList.remove('d-none');
    
    const selectedCoursesData = allCourses.filter(course => selectedCourses.has(course.value));
    
    // Calculate summary statistics
    let totalSKS = 0;
    const faculties = new Set();
    
    selectedCoursesData.forEach(course => {
        if (course.sks) totalSKS += parseInt(course.sks);
        if (course.faculty) faculties.add(course.faculty);
        
        const courseElement = createCourseCard(course, true, true);
        container.appendChild(courseElement);
    });
    
    // Update summary
    document.getElementById('totalSKS').textContent = totalSKS;
    document.getElementById('totalCourses').textContent = selectedCourses.size;
    document.getElementById('totalFaculties').textContent = faculties.size;
}

function createCourseCard(course, isSelected, isInSelectedArea) {
    const col = document.createElement('div');
    col.className = 'col-xl-4 col-lg-6 col-md-6';
    
    const card = document.createElement('div');
    card.className = `card course-card ${isSelected ? 'border-primary bg-primary bg-opacity-10' : 'border-secondary'} h-100`;
    card.style.cursor = 'pointer';
    card.style.transition = 'all 0.2s ease';
    card.setAttribute('data-course-value', course.value);
    
    const cardBody = document.createElement('div');
    cardBody.className = 'card-body p-3';
    
    const courseCode = document.createElement('h6');
    courseCode.className = `card-title mb-1 ${isSelected ? 'text-primary fw-bold' : ''}`;
    courseCode.innerHTML = `<i class="bi bi-book"></i> ${course.courseCode}`;
    
    const courseName = document.createElement('p');
    courseName.className = 'card-text small mb-2';
    courseName.textContent = course.courseName;
    
    const details = document.createElement('div');
    details.className = 'small text-muted mb-2';
    
    if (course.sks) {
        const sks = document.createElement('span');
        sks.className = 'badge bg-secondary me-1';
        sks.innerHTML = `<i class="bi bi-mortarboard"></i> ${course.sks} SKS`;
        details.appendChild(sks);
    }
    
    const faculty = document.createElement('div');
    faculty.className = 'small text-muted mt-1';
    faculty.innerHTML = `<i class="bi bi-building"></i> ${course.faculty}`;
    
    const selectIcon = document.createElement('div');
    selectIcon.className = 'text-end mt-2';
    
    if (isSelected) {
        selectIcon.innerHTML = '<i class="bi bi-check-circle-fill text-primary"></i> <small class="text-primary">Terpilih</small>';
    } else {
        selectIcon.innerHTML = '<i class="bi bi-plus-circle text-muted"></i> <small class="text-muted">Klik untuk pilih</small>';
    }
    
    cardBody.appendChild(courseCode);
    cardBody.appendChild(courseName);
    cardBody.appendChild(details);
    cardBody.appendChild(faculty);
    cardBody.appendChild(selectIcon);
    
    card.appendChild(cardBody);
    col.appendChild(card);
    
    // Add click event
    card.addEventListener('click', function() {
        toggleCourseSelection(course.value);
    });
    
    // Add hover effects
    card.addEventListener('mouseenter', function() {
        this.style.transform = 'translateY(-2px)';
        this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
    });
    
    card.addEventListener('mouseleave', function() {
        this.style.transform = 'translateY(0)';
        this.style.boxShadow = '';
    });
    
    return col;
}

function toggleCourseSelection(courseValue) {
    if (selectedCourses.has(courseValue)) {
        selectedCourses.delete(courseValue);
    } else {
        selectedCourses.add(courseValue);
    }
    
    // Update hidden select element
    updateHiddenSelect();
    
    // Re-render both areas
    const searchTerm = document.getElementById('courseSearch').value;
    const facultyFilter = document.getElementById('facultyFilter').value;
    renderAvailableCourses(searchTerm, facultyFilter);
    renderSelectedCourses();
    updateCounts();
}

function updateHiddenSelect() {
    const selectElement = document.querySelector('select[name="target_courses"]');
    
    // Clear all selections
    Array.from(selectElement.options).forEach(option => {
        option.selected = selectedCourses.has(option.value);
    });
}

function updateCounts() {
    document.getElementById('selectedCount').textContent = selectedCourses.size;
}

// Helper functions for mobile
function selectAllVisible() {
    const visibleCourses = document.querySelectorAll('#availableCourses .course-card');
    visibleCourses.forEach(card => {
        const courseValue = card.getAttribute('data-course-value');
        if (courseValue && !selectedCourses.has(courseValue)) {
            selectedCourses.add(courseValue);
        }
    });
    
    updateHiddenSelect();
    const searchTerm = document.getElementById('courseSearch').value;
    const facultyFilter = document.getElementById('facultyFilter').value;
    renderAvailableCourses(searchTerm, facultyFilter);
    renderSelectedCourses();
    updateCounts();
}

function clearAllSelections() {
    selectedCourses.clear();
    updateHiddenSelect();
    const searchTerm = document.getElementById('courseSearch').value;
    const facultyFilter = document.getElementById('facultyFilter').value;
    renderAvailableCourses(searchTerm, facultyFilter);
    renderSelectedCourses();
    updateCounts();
}

// CSS for course cards
const style = document.createElement('style');
style.textContent = `
    .course-card {
        transition: all 0.2s ease;
        min-height: 180px;
    }
    
    .course-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    
    .course-card.border-primary {
        border-width: 2px !important;
    }
    
    .course-card .card-body {
        display: flex;
        flex-direction: column;
        justify-content: space-between;
    }
    
    .course-card .card-title {
        font-size: 0.95rem;
        line-height: 1.3;
    }
    
    .course-card .card-text {
        font-size: 0.85rem;
        line-height: 1.4;
        flex-grow: 1;
    }
    
    /* Mobile optimizations */
    @media (max-width: 768px) {
        .course-card {
            min-height: 160px;
        }
        
        .course-card .card-body {
            padding: 0.75rem;
        }
        
        .course-card .card-title {
            font-size: 0.9rem;
        }
        
        .course-card .card-text {
            font-size: 0.8rem;
        }
        
        .course-card .small {
            font-size: 0.75rem;
        }
    }
    
    /* Tablet optimizations */
    @media (min-width: 769px) and (max-width: 991px) {
        .course-card {
            min-height: 170px;
        }
    }
    
    /* Search and filter improvements */
    #courseSearch:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }
    
    #facultyFilter:focus {
        border-color: #0d6efd;
        box-shadow: 0 0 0 0.2rem rgba(13, 110, 253, 0.25);
    }
    
    /* Selected courses area */
    #selectedCourses {
        min-height: 100px;
    }
    
    /* Available courses area */
    #availableCourses {
        min-height: 200px;
    }
    
    /* Badge improvements */
    .badge {
        font-size: 0.7rem;
    }
    
    /* Animation for course selection */
    .course-card {
        position: relative;
        overflow: hidden;
    }
    
    .course-card.border-primary::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #0d6efd, #6610f2);
        opacity: 0.8;
    }
`;
document.head.appendChild(style);
</script>

{% endblock %}
